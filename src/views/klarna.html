<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Klarna Checkout</title>
</head>

<body>

  <!-- Container for Klarna widget -->
  <div id="klarna-payments-container"></div>

  <!-- Optional: Buy button -->
  <button id="buy-button">Buy Now</button>

  <script>
    // Klarna SDK async callback
    window.klarnaAsyncCallback = function () {
      // 1. Initialize Klarna SDK
      Klarna.Payments.init({
        client_token: ''
      });

      // 2. Load Klarna widget
      Klarna.Payments.load(
        {
          container: '#klarna-payments-container'
        },
        {},
        function (res) {
          console.log("Load result:", res);
        }
      );
    };
  </script>

  <!-- Klarna SDK -->
  <script src="https://x.klarnacdn.net/kp/lib/v1/api.js" async></script>

  <script>
    // 3. Handle Buy button -> call authorize
    document.getElementById('buy-button').addEventListener('click', function () {
      Klarna.Payments.authorize(
        {},
        {
          billing_address: {
            given_name: "Alice",
            family_name: "Test",
            email: "customer@email.se",
            street_address: "SÃ¶dra Blasieholmshamnen 2",
            postal_code: "11148",
            city: "Stockholm",
            phone: "0701234567",
            country: "SE"
          }
        },
        function (res) {
          console.log("Authorize result:", res);
          if (res.approved) {
            alert("Payment approved! Authorization token: " + res.authorization_token);
          } else {
            alert("Payment not approved.");
          }
        }
      );
    });
  </script>
</body>

</html>